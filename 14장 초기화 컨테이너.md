# 14장 초기화 컨테이너
## 초기화 컨테이너 패턴 (Init Container pattern)
초기화 관련 작업에 개별 수명주기를 제공하여 메인 애플리케이션 컨테이너와 분리
할 수 있다.


**문제** 
1. 각각 컨테이너 별로 애플리케이션 형성을 시작하기 전에 필요조건이 다름.
e.g 파일 시스템, 데이터베이스 스키마 설정 등을 위한 특수 권한 부여, 별도로 필요한 도구, 라이브러리 설정 등 
2. 어떤 사용 예에서도 적용할 수 있도록, 쿠버네티스는 초기화 작업을 기본 애플리케이션과 분리하는 패턴에 초기화 컨테이너를 이용함.

**해결책**
**초기화 컨테이너란?**
* 파드 정의의 일부, 파드 내의 모든 컨테이너는 “초기화 컨테이너”와 “애플리케이션 컨테이너”로 나뉨.
* 순차적으로 하나씩 초기화 컨테이너 실행
* 애플리케이션 컨테이너가 시작되기 전에 모든 초기화 컨테이너가 성공적으로 종료되어야 함.
* 애플리케이션 컨테이너는 병렬로 실행, 시작 순서도 임의적
* 일반적으로 초기화 컨테이너는 사이즈가 작아야하고 빠르게 실행되고 완료되어야함.
* 초기화 컨테이너 실패 => 전체 파드 재시작, 모든 초기화 컨테이너도 재시작

초기화 컨테이너의 기능?
* 애플리케이션 컨테이너와 같이 자원 제한, 볼륨 및 보안 설정 공유하고 동일한 노드에 배치됨.
* 정상상태 확인(Health-check), 자원 처리 시맨틱이 애플리케이션 컨테이너와 차이점이 있음.
* 레디니스 체크는 X (애플리케이션 컨테이너 시작 전에 종료되어야해서)
* 초기화 컨테이너를 사용해 작업을 분리하여 컨테이너를 단일 목적으로 유지 가능.
=> 애플리케이션 컨테이너는 애플리케이션 엔지니어가, 배포 엔지니어는 초기화 컨테이너 작성, 구성, 초기화 작업을 진행
* HTTP 서비스 제공
* 복제된 파일을 초기화 컨테이너에서 애플리케이션 컨테이너로 공유 가능(동일 볼륨을 통해 데이터 공유)
=> 깃 클라이언트 기능을 통해 깃 레포를 복제한다. 

## 초기화 컨테이너 사용 외 초기화 기법 예
1. 어드미션 컨트롤러(Admission controller)
2. 어드미션 웹훅(Admission webhook)
3. 이니셜라이저(Initializer)
4. 파드프리세트(PodPreset)
위 기술들은 초기화 컨테이너가 쿠버네티스에 배포하는 개발자가 사용한다는 점과 달리 관리자가 컨테이너 초기화 프로세스를 제어하고 관리하기 위해 사용하는 기법 예이다. 

---
## Comment  
* 정혜수 : 초기화 컨테이너는 보안적인 이유로 앱 컨테이너의 이미지와 같이 두면 안되는 코드를 별도로 관리할때 사용할 수 있다고 합니다.  
https://kubernetes.io/ko/docs/concepts/workloads/pods/init-containers/  
